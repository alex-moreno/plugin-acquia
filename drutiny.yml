parameters:
    acquia.api.base_uri: https://cskb.acquia.com/
    cache.acquia_source_ttl: 2592000 # 30 Days
services:
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.
        public: true

    acquia.templates:
      class: Twig\Loader\FilesystemLoader
      arguments: [ '%acquia.twig_dir%' ] # See drutiny.php
      tags: [twig.loader]

    cache.acquia_source:
        class: Symfony\Component\Cache\Adapter\FilesystemAdapter
        arguments: [acquia_source, '%cache.acquia_source_ttl%', '%cache.directory%']
        calls:
          - [setLogger, ['@logger']]
          - [prune]

    target.acquia:
      class: Drutiny\Acquia\AcquiaTarget

    Drutiny\Acquia\Command\AcsfSetupCommand:
      tags: [command]
    Drutiny\Acquia\Command\AcsfListCommand:
      tags: [command]

    Drutiny\Acquia\Api\SourceApi:
      calls:
        - [setCache, ['@cache.acquia_source']]

    Drutiny\Acquia\Api\CloudApi:

    acquia.cloud.api:
      class: Drutiny\Acquia\Api\CloudApi

    Drutiny\Acquia\Source\PolicySource:
      tags: [policy.source]

    domain_list.acsf:
      class: Drutiny\Acquia\DomainList\AcquiaSiteFactoryDomainList
      tags: [domain_list]

    Drutiny\Acquia\Source\ProfileSource:
      tags: [profile.source]

    Drutiny\Acquia\PropertyBridge\CloudBridge:
      tags: [drutiny.event_subscriber]
    # makes classes in src/ available to be used as services
    # this creates a service per class whose id is the fully-qualified class name
    Drutiny\Acquia\Audit\:
        resource: 'src/Audit/*'

    Drutiny\Acquia\Plugin\:
        resource: 'src/Plugin/*'
        tags: [plugin]
        shared: false

    Drutiny\Acquia\AcquiaEnvExpressionFunction:
        tags: [drutiny.expression_language.function]
